<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Modern Job Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
  background: linear-gradient(to right, #667eea, #764ba2);
  color: #fff;
}
.sidebar {
  background: rgba(0,0,0,0.4);
  min-height: 100vh;
  padding: 20px;
}
.content {
  padding: 30px;
}
.card {
  border-radius: 15px;
}
.btn-custom {
  background: #ff7e5f;
  border: none;
}
</style>
</head>

<body>

<div class="container-fluid">
  <div class="row">

    <!-- Sidebar -->
    <div class="col-md-3 sidebar">
      <h3>Recruiter Panel</h3>
      <form id="jobForm">
        <input type="text" id="title" class="form-control mb-2" placeholder="Job Title" required>
        <input type="text" id="company" class="form-control mb-2" placeholder="Company" required>
        <input type="text" id="location" class="form-control mb-2" placeholder="Location" required>
        <textarea id="description" class="form-control mb-2" placeholder="Description" required></textarea>
        <button class="btn btn-light w-100">Post Job</button>
      </form>
    </div>

    <!-- Main Content -->
    <div class="col-md-9 content">
      <h2 class="mb-4">Available Jobs</h2>
      <div class="row" id="jobList"></div>

      <hr class="my-5">

      <h2>Applied Candidates</h2>
      <div class="row" id="applicantList"></div>
    </div>

  </div>
</div>

<!-- Apply Modal -->
<div class="modal fade" id="applyModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content text-dark">
      <div class="modal-header">
        <h5 class="modal-title">Apply for Job</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="applyForm">
          <input type="hidden" id="jobId">
          <input type="text" id="applicantName" class="form-control mb-3" placeholder="Your Name" required>
          <input type="email" id="applicantEmail" class="form-control mb-3" placeholder="Email" required>
          <input type="file" id="resumeFile" class="form-control mb-3" accept=".pdf,.doc,.docx" required>
          <button class="btn btn-primary w-100">Submit Application</button>
        </form>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
class Job {
  constructor(id, title, company, location, description) {
    this.id = id;
    this.title = title;
    this.company = company;
    this.location = location;
    this.description = description;
  }
}

class Applicant {
  constructor(jobId, name, email, resumeName, resumeData) {
    this.jobId = jobId;
    this.name = name;
    this.email = email;
    this.resumeName = resumeName;
    this.resumeData = resumeData;
  }
}

let jobs = JSON.parse(localStorage.getItem("jobs")) || [];
let applicants = JSON.parse(localStorage.getItem("applicants")) || [];

const jobForm = document.getElementById("jobForm");
const jobList = document.getElementById("jobList");
const applicantList = document.getElementById("applicantList");

jobForm.addEventListener("submit", e => {
  e.preventDefault();

  const newJob = new Job(
    Date.now(),
    title.value,
    company.value,
    location.value,
    description.value
  );

  jobs.push(newJob);
  localStorage.setItem("jobs", JSON.stringify(jobs));
  jobForm.reset();
  displayJobs();
});

function displayJobs() {
  jobList.innerHTML = "";

  jobs.forEach(job => {
    jobList.innerHTML += `
      <div class="col-md-6 mb-4">
        <div class="card p-3 text-dark shadow">
          <h5>${job.title}</h5>
          <p><b>${job.company}</b> | ${job.location}</p>
          <p>${job.description}</p>
          <button class="btn btn-success btn-sm"
            onclick="openApplyModal(${job.id})">
            Apply
          </button>
        </div>
      </div>
    `;
  });
}

function openApplyModal(jobId) {
  document.getElementById("jobId").value = jobId;
  new bootstrap.Modal(document.getElementById("applyModal")).show();
}

document.getElementById("applyForm").addEventListener("submit", function(e){
  e.preventDefault();

  const jobId = parseInt(document.getElementById("jobId").value);
  const name = applicantName.value;
  const email = applicantEmail.value;
  const file = resumeFile.files[0];

  const reader = new FileReader();
  reader.onload = function(event) {
    const applicant = new Applicant(
      jobId,
      name,
      email,
      file.name,
      event.target.result
    );

    applicants.push(applicant);
    localStorage.setItem("applicants", JSON.stringify(applicants));

    displayApplicants();
    bootstrap.Modal.getInstance(document.getElementById("applyModal")).hide();
    document.getElementById("applyForm").reset();
  };

  reader.readAsDataURL(file);
});

function displayApplicants() {
  applicantList.innerHTML = "";

  applicants.forEach(app => {
    const job = jobs.find(j => j.id === app.jobId);

    applicantList.innerHTML += `
      <div class="col-md-6 mb-4">
        <div class="card p-3 text-dark shadow">
          <h5>${app.name}</h5>
          <p>${app.email}</p>
          <p><b>Applied For:</b> ${job ? job.title : ""}</p>
          <a href="${app.resumeData}" 
             download="${app.resumeName}" 
             class="btn btn-primary btn-sm">
             View Resume
          </a>
        </div>
      </div>
    `;
  });
}

displayJobs();
displayApplicants();
</script>

</body>
</html>